# –†–∞–∑–¥–µ–ª –ê–Ω–∞–ª–∏—Ç–∏–∫–∏

## üìä –û–ø–∏—Å–∞–Ω–∏–µ

–†–∞–∑–¥–µ–ª –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel.

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- ‚úÖ –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –¥–∞—Ç (—Å/–ø–æ)
- ‚úÖ –í—ã–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–∞ –ø–æ –∑–∞—è–≤–∫–∞–º –≤ Excel —Å —Ü–≤–µ—Ç–Ω–æ–π —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –í—ã–≥—Ä—É–∑–∫–∞ –æ—Ç—á–µ—Ç–∞ –ø–æ —Ä–∞–±–æ—á–∏–º —á–∞—Å–∞–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ Excel
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è: –∫–Ω–æ–ø–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º (–æ—Ç—á–µ—Ç –ø–æ —á–∞—Å–∞–º)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ analytics/
‚îÇ       ‚îú‚îÄ‚îÄ index.ts          # API –º–µ—Ç–æ–¥—ã
‚îÇ       ‚îî‚îÄ‚îÄ types.ts          # TypeScript —Ç–∏–ø—ã
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ common/
        ‚îî‚îÄ‚îÄ analytics/
            ‚îú‚îÄ‚îÄ Analytics.vue     # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
            ‚îî‚îÄ‚îÄ useAnalytics.ts   # –õ–æ–≥–∏–∫–∞ –∏ composable
```

## üîß API

### 1. –û—Ç—á–µ—Ç –ø–æ –∑–∞—è–≤–∫–∞–º

**Endpoint**: `GET /analytics/tickets-report`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:

- `date_from` (string, required) - –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
- `date_to` (string, required) - –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

**–û—Ç–≤–µ—Ç**:

```typescript
{
  payload: {
    payload: TicketReportItem[]
    count: number
  }
  count: number
}
```

### 2. –û—Ç—á–µ—Ç –ø–æ —Ä–∞–±–æ—á–∏–º —á–∞—Å–∞–º

**Endpoint**: `GET /analytics/work-hours`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:

- `date_from` (string, required) - –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
- `date_to` (string, required) - –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

**–û—Ç–≤–µ—Ç**:

```typescript
{
  period: {
    from: string
    to: string
  }
  employees: WorkHoursEmployee[]
  totals: {
    total_hours: number
    days_worked: number
  }
}
```

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞

| –ö–æ–ª–æ–Ω–∫–∞              | –û–ø–∏—Å–∞–Ω–∏–µ                   |
| -------------------- | -------------------------- |
| –≠–ª–µ–º–µ–Ω—Ç ‚Ññ            | –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä           |
| –£—á–∞—Å—Ç–æ–∫              | –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞           |
| –û–±—ä–µ–∫—Ç               | –ù–æ–º–µ—Ä –ê–ó–°                  |
| –°—Ç–∞—Ç—É—Å               | –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏              |
| –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å          | –£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏        |
| –î–∞—Ç–∞ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏   | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è      |
| –î–∞—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞—è–≤–∫–∏ | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è      |
| –ó–∞—è–≤–∫–∏               | –°–ø–∏—Å–æ–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π |
| –§–ò–û                  | –ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞             |
| –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏    | –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç             |
| ‚Ññ –°–õ                 | –ù–æ–º–µ—Ä —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞     |
| –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å          | (—Ä–µ–∑–µ—Ä–≤)                   |
| –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π        | (—Ä–µ–∑–µ—Ä–≤)                   |
| –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ           | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏                |

## üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–î–æ—Å—Ç—É–ø –∏–º–µ—é—Ç —Ä–æ–ª–∏:

- `superadmin`
- `admin`
- `callCenter`

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞" –≤ –º–µ–Ω—é
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –¥–∞—Ç
3. –ù–∞–∂–º–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫:
   - **"–í—ã–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –∑–∞—è–≤–∫–∞–º"** - –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –∑–∞—è–≤–∫–∞–º —Å —Ü–≤–µ—Ç–Ω–æ–π
     —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–µ–π
   - **"–í—ã–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ —Ä–∞–±–æ—á–∏–º —á–∞—Å–∞–º"** - –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç—á–µ—Ç —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π
     —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
4. –§–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `exceljs` - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏ –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–µ–π

## üé® –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ Excel –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏:

| –°—Ç–∞—Ç—É—Å                 | –¶–≤–µ—Ç                        | –û–ø–∏—Å–∞–Ω–∏–µ                 |
| ---------------------- | --------------------------- | ------------------------ |
| `new`                  | üü° –ñ–µ–ª—Ç—ã–π (#FFEB3B)         | –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞             |
| `in_progress`          | üîµ –ì–æ–ª—É–±–æ–π (#64B5F6)        | –í —Ä–∞–±–æ—Ç–µ                 |
| `awaiting_approval`    | üü† –û—Ä–∞–Ω–∂–µ–≤—ã–π (#FFA726)      | –ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏          |
| `approved`             | üü¢ –ó–µ–ª–µ–Ω—ã–π (#81C784)        | –û–¥–æ–±—Ä–µ–Ω–∞                 |
| `rejected`             | üî¥ –ö—Ä–∞—Å–Ω—ã–π (#E57373)        | –û—Ç–∫–ª–æ–Ω–µ–Ω–∞                |
| `rejected_by_customer` | üî¥ –¢–µ–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π (#EF5350)  | –û—Ç–∫–ª–æ–Ω–µ–Ω–∞ –∑–∞–∫–∞–∑—á–∏–∫–æ–º     |
| `closed`               | üü¢ –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π (#A5D6A7) | –ó–∞–∫—Ä—ã—Ç–∞                  |
| `cancelled`            | ‚ö™ –°–µ—Ä—ã–π (#BDBDBD)          | –û—Ç–º–µ–Ω–µ–Ω–∞                 |
| `done_checked`         | üü¢ –Ø—Ä–∫–æ-–∑–µ–ª–µ–Ω—ã–π (#66BB6A)   | –í—ã–ø–æ–ª–Ω–µ–Ω–∞ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–∞)    |
| `done_unchecked`       | üü¢ –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π (#9CCC65) | –í—ã–ø–æ–ª–Ω–µ–Ω–∞ (–Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞) |

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel:

- –ó–∞–≥–æ–ª–æ–≤–æ–∫: –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç, —Å–µ—Ä—ã–π —Ñ–æ–Ω
- –í—Å–µ —è—á–µ–π–∫–∏: —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
- –ê–≤—Ç–æ–ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ –≤ –¥–ª–∏–Ω–Ω—ã—Ö —è—á–µ–π–∫–∞—Ö

## üìä –û—Ç—á–µ—Ç –ø–æ —Ä–∞–±–æ—á–∏–º —á–∞—Å–∞–º

–í—Ç–æ—Ä–æ–π –æ—Ç—á–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–∞—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞:

1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º** - –∫–∞–∂–¥—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –≤—ã–¥–µ–ª–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–º –±–ª–æ–∫–æ–º
2. **–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç**:
   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã
   - –ê–ó–° (–Ω–æ–º–µ—Ä –∏ –∞–¥—Ä–µ—Å)
   - –ù–æ–º–µ—Ä —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
   - –û–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
3. **–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞** - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:

- **–§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞**: –≥–æ–ª—É–±–æ–π —Ñ–æ–Ω (#E3F2FD), –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç
- **–î–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç**: –±–µ–ª—ã–π —Ñ–æ–Ω —Å —Å–µ—Ä—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
- **–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞**: –∂–µ–ª—Ç—ã–π —Ñ–æ–Ω (#FFF9C4), –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç

### –ò–º—è —Ñ–∞–π–ª–∞:

`–û—Ç—á–µ—Ç_—Ä–∞–±–æ—á–∏–µ_—á–∞—Å—ã_YYYY-MM-DD_YYYY-MM-DD.xlsx`

## ‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ—Ç—å–µ–≥–æ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤:

1. –î–æ–±–∞–≤—å—Ç–µ API –º–µ—Ç–æ–¥ –≤ `src/api/analytics/index.ts`:

```typescript
export const getSecondReport = async (
  dateFrom: string,
  dateTo: string
): Promise<SecondReportResponse> => {
  const response = await api.get<SecondReportResponse>(
    `/analytics/second-report`,
    {
      params: {
        date_from: dateFrom,
        date_to: dateTo,
      },
    }
  )
  return response.data
}
```

2. –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≤ `useAnalytics.ts`:

```typescript
const exportSecondReport = async () => {
  // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ exportTicketsReport
}
```

3. –û–±–Ω–æ–≤–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤ `Analytics.vue`:

```vue
<n-button
  type="primary"
  size="large"
  :disabled="!isDateRangeValid || loading"
  :loading="loading"
  @click="exportSecondReport"
>
  –í—ã–≥—Ä—É–∑–∏—Ç—å –≤—Ç–æ—Ä–æ–π –æ—Ç—á–µ—Ç
</n-button>
```
